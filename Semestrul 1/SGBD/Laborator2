SPOOL d:\sterge.sql;
SELECT 'DROP TABLE' || TABLE_NAME || ';'
FROM USER_TABLES
where table_name like('%242')
SPOOL OFF;


select MAX(COUNT(category))
from RENTAL
INNER JOIN TITLE USING (TITLE_ID)
GROUP BY CATEGORY 

SELECT *
FROM TITLE 
INNER JOIN RENTAL USING (TITLE_ID)
GROUP BY CATEGORY
    HAVING COUT(*)=(select MAX(COUNT(category))
        from RENTAL
        INNER JOIN TITLE USING (TITLE_ID)
        GROUP BY CATEGORY )
        
SELECT * 
FROM TITLE A 
INNER JOIN (select CATEGORY, MAX(COUNT(category))
            from RENTAL
            INNER JOIN TITLE USING (TITLE_ID)
            group by category
            having count(*)=max(count(category)))mxCat
ON A.CATEGORY=mxCat.category

--5
select TITLE_ID, COPY_ID FROM TITLE_COPY
MINUS 
SELECT TITLE_ID, COPY_ID
FROM RENTALS R
RIGHT JOIN TITLE_COPY T ON R.TITLE_ID = T.TITLE_ID
WHERE EXP_RET_DATE IS NULL) SQ ON T.TILE_ID = SQ.TITLE_ID

--10
SELECT LAST_NAME, FIRST_NAME , COUNT(COPY_ID)
FROM MEMBER M
INNER JOIN RENTAL T ON M.MEMBER_ID = T.MEMBER_ID
RIGHT JOIN TITLE_COPY TC ON T.COPY_ID = TC.COPY_ID
GROUP BY LAST_NAME, FIRST_NAME, COPY_ID
